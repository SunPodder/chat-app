import{c as g,j as a,U as u}from"./index-BhQeG5K_.js";import{A as v,a as b,b as F}from"./index-BZpRwNlR.js";import{B as p}from"./button-D0JERORw.js";import{C as y,a as N,b as C,c as S,I as o,d as U}from"./input-DDaKLcAe.js";import{u as k,F as w,a as m,b as c,c as d,d as x,e as j,o as L,v as P}from"./form-2pPfF0Uu.js";import{c as A}from"./createLucideIcon-8aQ_-RDO.js";import"./index-BqoLo0Hk.js";import"./index-utpKsIgz.js";/**
 * @license lucide-react v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I=A("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]),R=({user:e,form:h})=>{function s(l){if(l instanceof File)return URL.createObjectURL(l)}return a.jsx("div",{className:"w-full flex justify-center",children:a.jsx(m,{control:h.control,name:"avatar",render:({field:{value:l,onChange:f,...r}})=>{var n;return a.jsxs(c,{children:[a.jsx(d,{children:a.jsxs(v,{className:"flex relative cursor-pointer",children:[a.jsx(b,{src:s(l)||((n=e==null?void 0:e.avatar)==null?void 0:n.url),alt:e==null?void 0:e.name.first,className:"w-40 h-40 rounded-full"}),a.jsx(F,{children:e==null?void 0:e.name.first[0]}),a.jsx(I,{className:"w-10 h-10 absolute bottom-1 right-1 bg-background p-2 rounded-full"})]})}),a.jsx(x,{children:a.jsx(o,{...r,placeholder:"Avatar",type:"file",accept:"image/png, image/jpeg, image/jpg",onChange:i=>f(i.target.files&&i.target.files[0]),className:"hidden"})}),a.jsx(j,{})]})}})})};function T(){var f;const[e,h]=g(u),s=k({resolver:L(P),defaultValues:{email:e==null?void 0:e.email,username:e==null?void 0:e.username,name:{first:e==null?void 0:e.name.first,last:e==null?void 0:e.name.last},avatar:((f=e==null?void 0:e.avatar)==null?void 0:f.url)||""}});async function l(){var i;const r=new FormData;r.append("avatar",s.getValues("avatar")),r.append("name",JSON.stringify(s.getValues("name"))),r.append("username",s.getValues("username")),r.append("email",s.getValues("email"));const n=await fetch("/profile/edit",{method:"POST",body:r,credentials:"include",mode:"cors"});if(n.ok){const t=await n.json();h(t),s.reset({email:t.email,username:t.username,name:{first:t.name.first,last:t.name.last},avatar:((i=t.avatar)==null?void 0:i.url)||""})}}return a.jsxs(y,{className:"w-full h-full flex flex-col",children:[a.jsx(N,{children:a.jsx(C,{className:"py-2 flex items-center",children:a.jsx("span",{className:"flex-1",children:"Profile"})})}),a.jsx(w,{...s,children:a.jsxs("form",{onSubmit:s.handleSubmit(l),children:[a.jsxs(S,{children:[a.jsx(R,{user:e,form:s}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 mt-8 gap-4",children:[a.jsx(m,{control:s.control,name:"name.first",render:({field:r})=>a.jsxs(c,{children:[a.jsx(d,{children:"First name"}),a.jsx(x,{children:a.jsx(o,{placeholder:"First name",...r})}),a.jsx(j,{})]})}),a.jsx(m,{control:s.control,name:"name.last",render:({field:r})=>a.jsxs(c,{children:[a.jsx(d,{children:"Last name"}),a.jsx(x,{children:a.jsx(o,{placeholder:"Last name",...r})}),a.jsx(j,{})]})}),a.jsx(m,{control:s.control,name:"username",render:({field:r})=>a.jsxs(c,{children:[a.jsx(d,{children:"Username"}),a.jsx(x,{children:a.jsx(o,{placeholder:"Username",...r})}),a.jsx(j,{})]})}),a.jsx(m,{control:s.control,name:"email",render:({field:r})=>a.jsxs(c,{children:[a.jsx(d,{children:"Email"}),a.jsx(x,{children:a.jsx(o,{placeholder:"Email",...r})}),a.jsx(j,{})]})})]})]}),a.jsxs(U,{className:"flex gap-4 ml-4",children:[a.jsx(p,{disabled:!s.formState.isDirty,onClick:()=>s.reset(),children:"Reset"}),a.jsx(p,{disabled:!s.formState.isDirty,type:"submit",children:"Save"})]})]})})]})}export{T as default};
